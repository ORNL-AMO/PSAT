<style scoped>
	li {
		list-style-type:none;
	}
	li>span:not([onclick]) {
		opacity: .6;
	}	
	li>span[onclick]:hover {
		cursor: pointer;
		color: dodgerblue;
	}	
	li:first-child {
		display: none;
	}
	li>* {
		vertical-align: middle;
	}
</style>
<h1>Conditions</h1>
<ul>
    <li>        	
    	<button onclick='rm($(this))'><i class="fa fa-times"/></button>  
    	<span onclick='update(this)'></span>	
    </li>
</ul>
<hr>
<button onclick='nu()'>NEW</button>
<button>IMPORT</button>
<button>EXPORT</button>
<button onclick='removeAll()'>REMOVE ALL</button>
<button onclick='back()'>CANCEL</button>

<script>
	function nu() {
		Idx = Cond.length;
		$('#container').load('notes.html');
	}
	function removeAll() {
		LS.removeItem('conditions');
		Cond = [];
		Idx = 0;
		start();
		$(Main).find('td:nth-child(n+3),th:nth-child(n+3):nth-last-child(n+2)').remove();
		back();
	}
	function rm(e) {
		let i = e.parent().index()-1;
		Cond.splice(i,1);
		saveCond();
		e.parent().remove();
		Main.find('th').each(function(j,el) {
			let idx = $(el).data('idx');
			if (idx>i) {
				$(el).data('idx',--idx);
			}
		});
	}
	function update(e) {
		Idx = $(e).parent().index()-1;
		back();
		setPump();
	}
	function start() {
		$.each(Cond,function(i,e) {		
			let th = Main.find('th').filter(function(j,el) {
		      return i == $(el).data('idx');
		    });

			let nu = $('li').first().clone();
			nu.find('span').text(e.name);
			if (th.length>0) {
				nu.find('button').attr('disabled','');
				nu.find('span').removeAttr('onclick');					
			}
			$('ul').append(nu);		  
		});		
		if (Cond.length==0) {
			$('ul').html('<em>None</em>');
		}		
	}
	start();

</script>